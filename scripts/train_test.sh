#!/bin/bash
#SBATCH --partition=a40x
#SBATCH --job-name=openlmtest
#SBATCH --nodes 1
#SBATCH --account=chemnlp
#SBATCH --open-mode=append
#SBATCH --exclusive

module load openmpi
module load cuda/12.1

source ~/miniconda3/bin/activate
conda activate openllm

export MASTER_ADDR=$(hostname)
export MASTER_PORT=12802
export NCCL_PROTO=simple
export FI_EFA_FORK_SAFE=1
export FI_LOG_LEVEL=1
export FI_EFA_USE_DEVICE_RDMA=1
export NCCL_DEBUG=info

export PYTHONFAULTHANDLER=1

export CUDA_LAUNCH_BLOCKING=0
export OMPI_MCA_mtl_base_verbose=1
export FI_EFA_ENABLE_SHM_TRANSFER=0
export FI_PROVIDER=efa
export FI_EFA_TX_MIN_CREDITS=64
export NCCL_TREE_THRESHOLD=0

cd /weka/home-kjablonk/open_lm
export PYTHONPATH="$PYTHONPATH:/weka/home-kjablonk/open_lm"

BATCHSIZE=16
LR=1e-3
MODEL="open_lm_11m"
WD=0.1

EXP_NAME="openlm-test"

echo "node-list: $SLURM_JOB_NODELIST"

#  one epoch is --train-num-samples tokens

# total number of tokens in training data 257261367296 125'615'902 -> sequences in training data
# i want an epoch to be 10k steps
# hence, i need to set an epoch to x samples. I need to take into account batch size and the 2048 tokens per sequence
# 10k steps * 16 batch size * 2048 tokens per sequence = 327680000 tokens per epoch
# this is 0.001273724086302 of the training data
# i.e we need to set number of epochs to 785.099387500237618 to get one "real" epoch
# total number of tokens in val data 38324641792

srun --account chemnlp --cpu_bind=v --accel-bind=gn python -m open_lm.main \
    --train-num-samples 327680000 \
    --workers 8 \
    --train-data "pipe:aws s3 cp s3://llched-raw/open_lm_run_processed_data/nougat_process/nougat_chemrxiv_train/{5,6,3,7,0}/{shard-0000003,shard-0000002,shard-0000000,shard-0000006,shard-0000004,shard-0000007,shard-0000005,shard-0000001}.tar -" "pipe:aws s3 cp s3://llched-raw/open_lm_run_processed_data/msds/preproc_msds/{4,2,3,0}/{shard-0000257,shard-0000352,shard-0000151,shard-0000210,shard-0000096,shard-0000302,shard-0000025,shard-0000040,shard-0000218,shard-0000105,shard-0000261,shard-0000193,shard-0000091,shard-0000211,shard-0000204,shard-0000212,shard-0000317,shard-0000222,shard-0000268,shard-0000294,shard-0000267,shard-0000203,shard-0000145,shard-0000001,shard-0000181,shard-0000348,shard-0000026,shard-0000196,shard-0000101,shard-0000021,shard-0000231,shard-0000329,shard-0000115,shard-0000084,shard-0000015,shard-0000266,shard-0000206,shard-0000277,shard-0000011,shard-0000255,shard-0000301,shard-0000208,shard-0000143,shard-0000237,shard-0000075,shard-0000086,shard-0000248,shard-0000027,shard-0000022,shard-0000254,shard-0000339,shard-0000077,shard-0000295,shard-0000085,shard-0000106,shard-0000276,shard-0000162,shard-0000235,shard-0000069,shard-0000020,shard-0000226,shard-0000147,shard-0000207,shard-0000270,shard-0000202,shard-0000309,shard-0000199,shard-0000307,shard-0000136,shard-0000184,shard-0000340,shard-0000331,shard-0000216,shard-0000337,shard-0000234,shard-0000039,shard-0000064,shard-0000279,shard-0000033,shard-0000124,shard-0000095,shard-0000018,shard-0000185,shard-0000191,shard-0000240,shard-0000217,shard-0000111,shard-0000116,shard-0000197,shard-0000232,shard-0000158,shard-0000130,shard-0000148,shard-0000153,shard-0000052,shard-0000004,shard-0000112,shard-0000110,shard-0000050,shard-0000273,shard-0000098,shard-0000286,shard-0000104,shard-0000350,shard-0000190,shard-0000062,shard-0000251,shard-0000220,shard-0000028,shard-0000029,shard-0000036,shard-0000150,shard-0000250,shard-0000068,shard-0000246,shard-0000292,shard-0000314,shard-0000074,shard-0000335,shard-0000007,shard-0000149,shard-0000100,shard-0000259,shard-0000179,shard-0000164,shard-0000224,shard-0000205,shard-0000013,shard-0000059,shard-0000172,shard-0000269,shard-0000215,shard-0000241,shard-0000090,shard-0000034,shard-0000349,shard-0000291,shard-0000263,shard-0000281,shard-0000230,shard-0000346,shard-0000233,shard-0000330,shard-0000166,shard-0000165,shard-0000131,shard-0000311,shard-0000195,shard-0000070,shard-0000156,shard-0000120,shard-0000043,shard-0000256,shard-0000336,shard-0000144,shard-0000118,shard-0000225,shard-0000113,shard-0000054,shard-0000076,shard-0000122,shard-0000271,shard-0000334,shard-0000042,shard-0000249,shard-0000305,shard-0000121,shard-0000221,shard-0000160,shard-0000168,shard-0000227,shard-0000057,shard-0000303,shard-0000129,shard-0000265,shard-0000080,shard-0000327,shard-0000117,shard-0000019,shard-0000010,shard-0000089,shard-0000285,shard-0000024,shard-0000016,shard-0000312,shard-0000000,shard-0000079,shard-0000030,shard-0000245,shard-0000282,shard-0000102,shard-0000045,shard-0000048,shard-0000141,shard-0000142,shard-0000178,shard-0000046,shard-0000198,shard-0000163,shard-0000209,shard-0000063,shard-0000180,shard-0000347,shard-0000306,shard-0000258,shard-0000139,shard-0000159,shard-0000047,shard-0000152,shard-0000087,shard-0000319,shard-0000114,shard-0000297,shard-0000169,shard-0000238,shard-0000253,shard-0000244,shard-0000078,shard-0000005,shard-0000260,shard-0000283,shard-0000009,shard-0000017,shard-0000065,shard-0000097,shard-0000228,shard-0000023,shard-0000154,shard-0000134,shard-0000298,shard-0000092,shard-0000242,shard-0000155,shard-0000123,shard-0000127,shard-0000342,shard-0000188,shard-0000243,shard-0000275,shard-0000262,shard-0000133,shard-0000081,shard-0000288,shard-0000170,shard-0000182,shard-0000272,shard-0000177,shard-0000060,shard-0000315,shard-0000103,shard-0000214,shard-0000189,shard-0000316,shard-0000333,shard-0000341,shard-0000067,shard-0000128,shard-0000041,shard-0000061,shard-0000132,shard-0000055,shard-0000051,shard-0000053,shard-0000322,shard-0000012,shard-0000171,shard-0000071,shard-0000192,shard-0000318,shard-0000035,shard-0000264,shard-0000280,shard-0000200,shard-0000146,shard-0000140,shard-0000135,shard-0000173,shard-0000293,shard-0000044,shard-0000109,shard-0000296,shard-0000082,shard-0000321,shard-0000186,shard-0000157,shard-0000031,shard-0000239,shard-0000037,shard-0000229,shard-0000320,shard-0000183,shard-0000223,shard-0000284,shard-0000313,shard-0000328,shard-0000088,shard-0000038,shard-0000003,shard-0000247,shard-0000287,shard-0000125,shard-0000119,shard-0000325,shard-0000300,shard-0000138,shard-0000194,shard-0000289,shard-0000032,shard-0000174,shard-0000187,shard-0000008,shard-0000126,shard-0000308,shard-0000344,shard-0000338,shard-0000099,shard-0000332,shard-0000213,shard-0000304,shard-0000066,shard-0000175,shard-0000072,shard-0000299,shard-0000324,shard-0000161,shard-0000049,shard-0000278,shard-0000236,shard-0000006,shard-0000252,shard-0000353,shard-0000201,shard-0000083,shard-0000310,shard-0000014,shard-0000093,shard-0000107,shard-0000345,shard-0000176,shard-0000219,shard-0000167,shard-0000094,shard-0000137,shard-0000002,shard-0000323,shard-0000058,shard-0000274,shard-0000326,shard-0000343,shard-0000073,shard-0000108,shard-0000351,shard-0000056,shard-0000290}.tar -" "pipe:aws s3 cp s3://llched-raw/open_lm_run_processed_data/peS2o/preproc_data_peS2o_train_clean/{5,2,4,3,0,6,7,1}/{shard-0000257,shard-0000371,shard-0000432,shard-0000489,shard-0000352,shard-0000151,shard-0000210,shard-0000096,shard-0000302,shard-0000025,shard-0000040,shard-0000428,shard-0000218,shard-0000105,shard-0000261,shard-0000193,shard-0000091,shard-0000354,shard-0000211,shard-0000450,shard-0000535,shard-0000204,shard-0000484,shard-0000483,shard-0000212,shard-0000539,shard-0000317,shard-0000222,shard-0000437,shard-0000268,shard-0000294,shard-0000267,shard-0000552,shard-0000520,shard-0000558,shard-0000430,shard-0000203,shard-0000555,shard-0000145,shard-0000001,shard-0000181,shard-0000348,shard-0000358,shard-0000525,shard-0000026,shard-0000388,shard-0000547,shard-0000499,shard-0000196,shard-0000538,shard-0000101,shard-0000021,shard-0000360,shard-0000231,shard-0000513,shard-0000519,shard-0000329,shard-0000115,shard-0000084,shard-0000427,shard-0000015,shard-0000266,shard-0000206,shard-0000277,shard-0000011,shard-0000255,shard-0000301,shard-0000411,shard-0000208,shard-0000143,shard-0000237,shard-0000075,shard-0000086,shard-0000248,shard-0000415,shard-0000027,shard-0000022,shard-0000492,shard-0000254,shard-0000482,shard-0000339,shard-0000491,shard-0000367,shard-0000077,shard-0000295,shard-0000085,shard-0000106,shard-0000473,shard-0000276,shard-0000162,shard-0000235,shard-0000069,shard-0000020,shard-0000226,shard-0000147,shard-0000207,shard-0000270,shard-0000557,shard-0000202,shard-0000530,shard-0000309,shard-0000386,shard-0000199,shard-0000307,shard-0000136,shard-0000451,shard-0000184,shard-0000477,shard-0000340,shard-0000368,shard-0000512,shard-0000331,shard-0000382,shard-0000510,shard-0000216,shard-0000337,shard-0000234,shard-0000039,shard-0000064,shard-0000279,shard-0000448,shard-0000493,shard-0000033,shard-0000124,shard-0000095,shard-0000018,shard-0000185,shard-0000191,shard-0000506,shard-0000240,shard-0000217,shard-0000429,shard-0000111,shard-0000116,shard-0000197,shard-0000479,shard-0000232,shard-0000158,shard-0000130,shard-0000550,shard-0000474,shard-0000148,shard-0000359,shard-0000529,shard-0000153,shard-0000052,shard-0000401,shard-0000004,shard-0000112,shard-0000392,shard-0000110,shard-0000472,shard-0000050,shard-0000273,shard-0000098,shard-0000286,shard-0000490,shard-0000104,shard-0000350,shard-0000509,shard-0000190,shard-0000534,shard-0000062,shard-0000251,shard-0000220,shard-0000028,shard-0000029,shard-0000036,shard-0000396,shard-0000445,shard-0000150,shard-0000515,shard-0000470,shard-0000250,shard-0000356,shard-0000068,shard-0000246,shard-0000292,shard-0000454,shard-0000314,shard-0000507,shard-0000425,shard-0000074,shard-0000335,shard-0000559,shard-0000517,shard-0000007,shard-0000461,shard-0000149,shard-0000465,shard-0000485,shard-0000100,shard-0000439,shard-0000259,shard-0000179,shard-0000164,shard-0000224,shard-0000363,shard-0000393,shard-0000205,shard-0000380,shard-0000013,shard-0000471,shard-0000554,shard-0000059,shard-0000172,shard-0000269,shard-0000215,shard-0000395,shard-0000412,shard-0000469,shard-0000241,shard-0000090,shard-0000376,shard-0000501,shard-0000034,shard-0000349,shard-0000291,shard-0000263,shard-0000379,shard-0000421,shard-0000281,shard-0000230,shard-0000409,shard-0000346,shard-0000233,shard-0000330,shard-0000414,shard-0000390,shard-0000166,shard-0000441,shard-0000165,shard-0000420,shard-0000383,shard-0000377,shard-0000548,shard-0000131,shard-0000311,shard-0000195,shard-0000070,shard-0000156,shard-0000120,shard-0000468,shard-0000542,shard-0000043,shard-0000256,shard-0000336,shard-0000398,shard-0000144,shard-0000536,shard-0000118,shard-0000225,shard-0000113,shard-0000054,shard-0000560,shard-0000076,shard-0000122,shard-0000271,shard-0000334,shard-0000551,shard-0000042,shard-0000249,shard-0000424,shard-0000305,shard-0000121,shard-0000362,shard-0000375,shard-0000497,shard-0000221,shard-0000160,shard-0000466,shard-0000168,shard-0000227,shard-0000385,shard-0000453,shard-0000057,shard-0000522,shard-0000460,shard-0000303,shard-0000129,shard-0000265,shard-0000449,shard-0000540,shard-0000080,shard-0000374,shard-0000327,shard-0000434,shard-0000117,shard-0000503,shard-0000019,shard-0000010,shard-0000089,shard-0000285,shard-0000024,shard-0000016,shard-0000365,shard-0000312,shard-0000000,shard-0000419,shard-0000079,shard-0000498,shard-0000030,shard-0000245,shard-0000282,shard-0000102,shard-0000045,shard-0000048,shard-0000526,shard-0000141,shard-0000142,shard-0000366,shard-0000532,shard-0000545,shard-0000178,shard-0000046,shard-0000198,shard-0000163,shard-0000209,shard-0000063,shard-0000180,shard-0000347,shard-0000391,shard-0000372,shard-0000306,shard-0000258,shard-0000139,shard-0000159,shard-0000047,shard-0000152,shard-0000426,shard-0000087,shard-0000549,shard-0000319,shard-0000114,shard-0000297,shard-0000169,shard-0000446,shard-0000373,shard-0000459,shard-0000455,shard-0000384,shard-0000238,shard-0000394,shard-0000464,shard-0000253,shard-0000528,shard-0000244,shard-0000078,shard-0000005,shard-0000260,shard-0000283,shard-0000009,shard-0000017,shard-0000065,shard-0000097,shard-0000228,shard-0000023,shard-0000154,shard-0000134,shard-0000298,shard-0000478,shard-0000092,shard-0000370,shard-0000433,shard-0000242,shard-0000369,shard-0000155,shard-0000123,shard-0000127,shard-0000342,shard-0000457,shard-0000481,shard-0000527,shard-0000435,shard-0000544,shard-0000188,shard-0000243,shard-0000275,shard-0000417,shard-0000262,shard-0000537,shard-0000133,shard-0000494,shard-0000081,shard-0000288,shard-0000170,shard-0000406,shard-0000182,shard-0000404,shard-0000272,shard-0000387,shard-0000177,shard-0000060,shard-0000315,shard-0000103,shard-0000214,shard-0000189,shard-0000316,shard-0000333,shard-0000378,shard-0000341,shard-0000508,shard-0000495,shard-0000067,shard-0000533,shard-0000416,shard-0000128,shard-0000041,shard-0000061,shard-0000132,shard-0000055,shard-0000397,shard-0000553,shard-0000051,shard-0000053,shard-0000322,shard-0000012,shard-0000171,shard-0000071,shard-0000521,shard-0000192,shard-0000475,shard-0000318,shard-0000035,shard-0000264,shard-0000280,shard-0000422,shard-0000200,shard-0000146,shard-0000140,shard-0000476,shard-0000364,shard-0000556,shard-0000135,shard-0000173,shard-0000486,shard-0000399,shard-0000293,shard-0000044,shard-0000109,shard-0000296,shard-0000082,shard-0000321,shard-0000186,shard-0000511,shard-0000531,shard-0000543,shard-0000157,shard-0000031,shard-0000239,shard-0000037,shard-0000229,shard-0000447,shard-0000516,shard-0000320,shard-0000444,shard-0000405,shard-0000523,shard-0000442,shard-0000183,shard-0000223,shard-0000467,shard-0000284,shard-0000463,shard-0000313,shard-0000328,shard-0000504,shard-0000456,shard-0000088,shard-0000038,shard-0000003,shard-0000247,shard-0000287,shard-0000400,shard-0000125,shard-0000119,shard-0000500,shard-0000325,shard-0000462,shard-0000357,shard-0000300,shard-0000480,shard-0000138,shard-0000514,shard-0000194,shard-0000381,shard-0000407,shard-0000289,shard-0000032,shard-0000440,shard-0000174,shard-0000187,shard-0000008,shard-0000126,shard-0000308,shard-0000344,shard-0000408,shard-0000338,shard-0000413,shard-0000099,shard-0000332,shard-0000488,shard-0000213,shard-0000304,shard-0000066,shard-0000175,shard-0000072,shard-0000452,shard-0000502,shard-0000458,shard-0000355,shard-0000299,shard-0000324,shard-0000402,shard-0000161,shard-0000049,shard-0000443,shard-0000518,shard-0000278,shard-0000505,shard-0000236,shard-0000006,shard-0000436,shard-0000252,shard-0000353,shard-0000389,shard-0000418,shard-0000201,shard-0000083,shard-0000310,shard-0000014,shard-0000093,shard-0000107,shard-0000361,shard-0000345,shard-0000176,shard-0000487,shard-0000541,shard-0000546,shard-0000219,shard-0000167,shard-0000094,shard-0000137,shard-0000002,shard-0000323,shard-0000403,shard-0000058,shard-0000274,shard-0000326,shard-0000343,shard-0000073,shard-0000496,shard-0000524,shard-0000108,shard-0000410,shard-0000351,shard-0000056,shard-0000438,shard-0000431,shard-0000290,shard-0000423}.tar -" "pipe:aws s3 cp s3://llched-raw/open_lm_run_processed_data/sampled_process/train_00_preproc/{5,2,4,3,0,6,7,1}/{shard-0000257,shard-0000371,shard-0000432,shard-0000352,shard-0000151,shard-0000210,shard-0000096,shard-0000302,shard-0000025,shard-0000040,shard-0000428,shard-0000218,shard-0000105,shard-0000261,shard-0000193,shard-0000091,shard-0000354,shard-0000211,shard-0000450,shard-0000204,shard-0000483,shard-0000212,shard-0000317,shard-0000222,shard-0000437,shard-0000268,shard-0000294,shard-0000267,shard-0000430,shard-0000203,shard-0000145,shard-0000001,shard-0000181,shard-0000348,shard-0000358,shard-0000026,shard-0000388,shard-0000196,shard-0000101,shard-0000021,shard-0000360,shard-0000231,shard-0000329,shard-0000115,shard-0000084,shard-0000427,shard-0000015,shard-0000266,shard-0000206,shard-0000277,shard-0000011,shard-0000255,shard-0000301,shard-0000411,shard-0000208,shard-0000143,shard-0000237,shard-0000075,shard-0000086,shard-0000248,shard-0000415,shard-0000027,shard-0000022,shard-0000254,shard-0000482,shard-0000339,shard-0000367,shard-0000077,shard-0000295,shard-0000085,shard-0000106,shard-0000473,shard-0000276,shard-0000162,shard-0000235,shard-0000069,shard-0000020,shard-0000226,shard-0000147,shard-0000207,shard-0000270,shard-0000202,shard-0000309,shard-0000386,shard-0000199,shard-0000307,shard-0000136,shard-0000451,shard-0000184,shard-0000477,shard-0000340,shard-0000368,shard-0000331,shard-0000382,shard-0000216,shard-0000337,shard-0000234,shard-0000039,shard-0000064,shard-0000279,shard-0000448,shard-0000033,shard-0000124,shard-0000095,shard-0000018,shard-0000185,shard-0000191,shard-0000240,shard-0000217,shard-0000429,shard-0000111,shard-0000116,shard-0000197,shard-0000479,shard-0000232,shard-0000158,shard-0000130,shard-0000474,shard-0000148,shard-0000359,shard-0000153,shard-0000052,shard-0000401,shard-0000004,shard-0000112,shard-0000392,shard-0000110,shard-0000472,shard-0000050,shard-0000273,shard-0000098,shard-0000286,shard-0000104,shard-0000350,shard-0000190,shard-0000062,shard-0000251,shard-0000220,shard-0000028,shard-0000029,shard-0000036,shard-0000396,shard-0000445,shard-0000150,shard-0000470,shard-0000250,shard-0000356,shard-0000068,shard-0000246,shard-0000292,shard-0000454,shard-0000314,shard-0000425,shard-0000074,shard-0000335,shard-0000007,shard-0000461,shard-0000149,shard-0000465,shard-0000100,shard-0000439,shard-0000259,shard-0000179,shard-0000164,shard-0000224,shard-0000363,shard-0000393,shard-0000205,shard-0000380,shard-0000013,shard-0000471,shard-0000059,shard-0000172,shard-0000269,shard-0000215,shard-0000395,shard-0000412,shard-0000469,shard-0000241,shard-0000090,shard-0000376,shard-0000034,shard-0000349,shard-0000291,shard-0000263,shard-0000379,shard-0000421,shard-0000281,shard-0000230,shard-0000409,shard-0000346,shard-0000233,shard-0000330,shard-0000414,shard-0000390,shard-0000166,shard-0000441,shard-0000165,shard-0000420,shard-0000383,shard-0000377,shard-0000131,shard-0000311,shard-0000195,shard-0000070,shard-0000156,shard-0000120,shard-0000468,shard-0000043,shard-0000256,shard-0000336,shard-0000398,shard-0000144,shard-0000118,shard-0000225,shard-0000113,shard-0000054,shard-0000076,shard-0000122,shard-0000271,shard-0000334,shard-0000042,shard-0000249,shard-0000424,shard-0000305,shard-0000121,shard-0000362,shard-0000375,shard-0000221,shard-0000160,shard-0000466,shard-0000168,shard-0000227,shard-0000385,shard-0000453,shard-0000057,shard-0000460,shard-0000303,shard-0000129,shard-0000265,shard-0000449,shard-0000080,shard-0000374,shard-0000327,shard-0000434,shard-0000117,shard-0000019,shard-0000010,shard-0000089,shard-0000285,shard-0000024,shard-0000016,shard-0000365,shard-0000312,shard-0000000,shard-0000419,shard-0000079,shard-0000030,shard-0000245,shard-0000282,shard-0000102,shard-0000045,shard-0000048,shard-0000141,shard-0000142,shard-0000366,shard-0000178,shard-0000046,shard-0000198,shard-0000163,shard-0000209,shard-0000063,shard-0000180,shard-0000347,shard-0000391,shard-0000372,shard-0000306,shard-0000258,shard-0000139,shard-0000159,shard-0000047,shard-0000152,shard-0000426,shard-0000087,shard-0000319,shard-0000114,shard-0000297,shard-0000169,shard-0000446,shard-0000373,shard-0000459,shard-0000455,shard-0000384,shard-0000238,shard-0000394,shard-0000464,shard-0000253,shard-0000244,shard-0000078,shard-0000005,shard-0000260,shard-0000283,shard-0000009,shard-0000017,shard-0000065,shard-0000097,shard-0000228,shard-0000023,shard-0000154,shard-0000134,shard-0000298,shard-0000478,shard-0000092,shard-0000370,shard-0000433,shard-0000242,shard-0000369,shard-0000155,shard-0000123,shard-0000127,shard-0000342,shard-0000457,shard-0000481,shard-0000435,shard-0000188,shard-0000243,shard-0000275,shard-0000417,shard-0000262,shard-0000133,shard-0000081,shard-0000288,shard-0000170,shard-0000406,shard-0000182,shard-0000404,shard-0000272,shard-0000387,shard-0000177,shard-0000060,shard-0000315,shard-0000103,shard-0000214,shard-0000189,shard-0000316,shard-0000333,shard-0000378,shard-0000341,shard-0000067,shard-0000416,shard-0000128,shard-0000041,shard-0000061,shard-0000132,shard-0000055,shard-0000397,shard-0000051,shard-0000053,shard-0000322,shard-0000012,shard-0000171,shard-0000071,shard-0000192,shard-0000475,shard-0000318,shard-0000035,shard-0000264,shard-0000280,shard-0000422,shard-0000200,shard-0000146,shard-0000140,shard-0000476,shard-0000364,shard-0000135,shard-0000173,shard-0000399,shard-0000293,shard-0000044,shard-0000109,shard-0000296,shard-0000082,shard-0000321,shard-0000186,shard-0000157,shard-0000031,shard-0000239,shard-0000037,shard-0000229,shard-0000447,shard-0000320,shard-0000444,shard-0000405,shard-0000442,shard-0000183,shard-0000223,shard-0000467,shard-0000284,shard-0000463,shard-0000313,shard-0000328,shard-0000456,shard-0000088,shard-0000038,shard-0000003,shard-0000247,shard-0000287,shard-0000400,shard-0000125,shard-0000119,shard-0000325,shard-0000462,shard-0000357,shard-0000300,shard-0000480,shard-0000138,shard-0000194,shard-0000381,shard-0000407,shard-0000289,shard-0000032,shard-0000440,shard-0000174,shard-0000187,shard-0000008,shard-0000126,shard-0000308,shard-0000344,shard-0000408,shard-0000338,shard-0000413,shard-0000099,shard-0000332,shard-0000213,shard-0000304,shard-0000066,shard-0000175,shard-0000072,shard-0000452,shard-0000458,shard-0000355,shard-0000299,shard-0000324,shard-0000402,shard-0000161,shard-0000049,shard-0000443,shard-0000278,shard-0000236,shard-0000006,shard-0000436,shard-0000252,shard-0000353,shard-0000389,shard-0000418,shard-0000201,shard-0000083,shard-0000310,shard-0000014,shard-0000093,shard-0000107,shard-0000361,shard-0000345,shard-0000176,shard-0000219,shard-0000167,shard-0000094,shard-0000137,shard-0000002,shard-0000323,shard-0000403,shard-0000058,shard-0000274,shard-0000326,shard-0000343,shard-0000073,shard-0000108,shard-0000410,shard-0000351,shard-0000056,shard-0000438,shard-0000431,shard-0000290,shard-0000423}.tar -" "pipe:aws s3 cp s3://llched-raw/open_lm_run_processed_data/nougat_process/nougat_medrxiv_train/{2,4,6,0,7,1}/{shard-0000003,shard-0000002,shard-0000000,shard-0000006,shard-0000004,shard-0000007,shard-0000005,shard-0000001}.tar -" "pipe:aws s3 cp s3://llched-raw/open_lm_run_processed_data/open-web-math/preproc_data_proof-pile-2_open-web-math_train/{5,2,4,3,0,6,7,1}/{shard-0000055,shard-0000052,shard-0000057,shard-0000096,shard-0000004,shard-0000051,shard-0000112,shard-0000025,shard-0000040,shard-0000110,shard-0000105,shard-0000080,shard-0000053,shard-0000050,shard-0000012,shard-0000091,shard-0000098,shard-0000104,shard-0000071,shard-0000019,shard-0000062,shard-0000010,shard-0000089,shard-0000035,shard-0000024,shard-0000016,shard-0000000,shard-0000028,shard-0000079,shard-0000029,shard-0000036,shard-0000030,shard-0000102,shard-0000045,shard-0000048,shard-0000044,shard-0000109,shard-0000068,shard-0000001,shard-0000046,shard-0000082,shard-0000026,shard-0000063,shard-0000031,shard-0000101,shard-0000037,shard-0000074,shard-0000021,shard-0000047,shard-0000007,shard-0000084,shard-0000100,shard-0000087,shard-0000015,shard-0000011,shard-0000114,shard-0000088,shard-0000038,shard-0000013,shard-0000003,shard-0000075,shard-0000086,shard-0000059,shard-0000027,shard-0000022,shard-0000090,shard-0000032,shard-0000077,shard-0000085,shard-0000106,shard-0000008,shard-0000078,shard-0000005,shard-0000009,shard-0000017,shard-0000034,shard-0000065,shard-0000069,shard-0000097,shard-0000099,shard-0000020,shard-0000066,shard-0000072,shard-0000023,shard-0000092,shard-0000049,shard-0000070,shard-0000006,shard-0000043,shard-0000113,shard-0000039,shard-0000064,shard-0000081,shard-0000083,shard-0000054,shard-0000033,shard-0000014,shard-0000076,shard-0000093,shard-0000107,shard-0000095,shard-0000018,shard-0000094,shard-0000111,shard-0000060,shard-0000002,shard-0000058,shard-0000103,shard-0000042,shard-0000073,shard-0000108,shard-0000067,shard-0000056,shard-0000041,shard-0000061}.tar -" "pipe:aws s3 cp s3://llched-raw/open_lm_run_processed_data/nougat_process/nougat_bioxriv_train/{5,2,4,3,0,6,7,1}/{shard-0000003,shard-0000002,shard-0000000,shard-0000006,shard-0000004,shard-0000007,shard-0000005,shard-0000001}.tar -" "pipe:aws s3 cp s3://llched-raw/open_lm_run_processed_data/europmc_train/preproc_data_europmc_ft_train/{5,2,4,3,0,6,7,1}/{shard-0000257,shard-0000352,shard-0000151,shard-0000210,shard-0000096,shard-0000302,shard-0000025,shard-0000040,shard-0000218,shard-0000105,shard-0000261,shard-0000193,shard-0000091,shard-0000211,shard-0000204,shard-0000212,shard-0000317,shard-0000222,shard-0000268,shard-0000294,shard-0000267,shard-0000203,shard-0000145,shard-0000001,shard-0000181,shard-0000348,shard-0000026,shard-0000196,shard-0000101,shard-0000021,shard-0000231,shard-0000329,shard-0000115,shard-0000084,shard-0000015,shard-0000266,shard-0000206,shard-0000277,shard-0000011,shard-0000255,shard-0000301,shard-0000208,shard-0000143,shard-0000237,shard-0000075,shard-0000086,shard-0000248,shard-0000027,shard-0000022,shard-0000254,shard-0000339,shard-0000077,shard-0000295,shard-0000085,shard-0000106,shard-0000276,shard-0000162,shard-0000235,shard-0000069,shard-0000020,shard-0000226,shard-0000147,shard-0000207,shard-0000270,shard-0000202,shard-0000309,shard-0000199,shard-0000307,shard-0000136,shard-0000184,shard-0000340,shard-0000331,shard-0000216,shard-0000337,shard-0000234,shard-0000039,shard-0000064,shard-0000279,shard-0000033,shard-0000124,shard-0000095,shard-0000018,shard-0000185,shard-0000191,shard-0000240,shard-0000217,shard-0000111,shard-0000116,shard-0000197,shard-0000232,shard-0000158,shard-0000130,shard-0000148,shard-0000153,shard-0000052,shard-0000004,shard-0000112,shard-0000110,shard-0000050,shard-0000273,shard-0000098,shard-0000286,shard-0000104,shard-0000350,shard-0000190,shard-0000062,shard-0000251,shard-0000220,shard-0000028,shard-0000029,shard-0000036,shard-0000150,shard-0000250,shard-0000068,shard-0000246,shard-0000292,shard-0000314,shard-0000074,shard-0000335,shard-0000007,shard-0000149,shard-0000100,shard-0000259,shard-0000179,shard-0000164,shard-0000224,shard-0000205,shard-0000013,shard-0000059,shard-0000172,shard-0000269,shard-0000215,shard-0000241,shard-0000090,shard-0000034,shard-0000349,shard-0000291,shard-0000263,shard-0000281,shard-0000230,shard-0000346,shard-0000233,shard-0000330,shard-0000166,shard-0000165,shard-0000131,shard-0000311,shard-0000195,shard-0000070,shard-0000156,shard-0000120,shard-0000043,shard-0000256,shard-0000336,shard-0000144,shard-0000118,shard-0000225,shard-0000113,shard-0000054,shard-0000076,shard-0000122,shard-0000271,shard-0000334,shard-0000042,shard-0000249,shard-0000305,shard-0000121,shard-0000221,shard-0000160,shard-0000168,shard-0000227,shard-0000057,shard-0000303,shard-0000129,shard-0000265,shard-0000080,shard-0000327,shard-0000117,shard-0000019,shard-0000010,shard-0000089,shard-0000285,shard-0000024,shard-0000016,shard-0000312,shard-0000000,shard-0000079,shard-0000030,shard-0000245,shard-0000282,shard-0000102,shard-0000045,shard-0000048,shard-0000141,shard-0000142,shard-0000178,shard-0000046,shard-0000198,shard-0000163,shard-0000209,shard-0000063,shard-0000180,shard-0000347,shard-0000306,shard-0000258,shard-0000139,shard-0000159,shard-0000047,shard-0000152,shard-0000087,shard-0000319,shard-0000114,shard-0000297,shard-0000169,shard-0000238,shard-0000253,shard-0000244,shard-0000078,shard-0000005,shard-0000260,shard-0000283,shard-0000009,shard-0000017,shard-0000065,shard-0000097,shard-0000228,shard-0000023,shard-0000154,shard-0000134,shard-0000298,shard-0000092,shard-0000242,shard-0000155,shard-0000123,shard-0000127,shard-0000342,shard-0000188,shard-0000243,shard-0000275,shard-0000262,shard-0000133,shard-0000081,shard-0000288,shard-0000170,shard-0000182,shard-0000272,shard-0000177,shard-0000060,shard-0000315,shard-0000103,shard-0000214,shard-0000189,shard-0000316,shard-0000333,shard-0000341,shard-0000067,shard-0000128,shard-0000041,shard-0000061,shard-0000132,shard-0000055,shard-0000051,shard-0000053,shard-0000322,shard-0000012,shard-0000171,shard-0000071,shard-0000192,shard-0000318,shard-0000035,shard-0000264,shard-0000280,shard-0000200,shard-0000146,shard-0000140,shard-0000135,shard-0000173,shard-0000293,shard-0000044,shard-0000109,shard-0000296,shard-0000082,shard-0000321,shard-0000186,shard-0000157,shard-0000031,shard-0000239,shard-0000037,shard-0000229,shard-0000320,shard-0000183,shard-0000223,shard-0000284,shard-0000313,shard-0000328,shard-0000088,shard-0000038,shard-0000003,shard-0000247,shard-0000287,shard-0000125,shard-0000119,shard-0000325,shard-0000300,shard-0000138,shard-0000194,shard-0000289,shard-0000032,shard-0000174,shard-0000187,shard-0000008,shard-0000126,shard-0000308,shard-0000344,shard-0000338,shard-0000099,shard-0000332,shard-0000213,shard-0000304,shard-0000066,shard-0000175,shard-0000072,shard-0000299,shard-0000324,shard-0000161,shard-0000049,shard-0000278,shard-0000236,shard-0000006,shard-0000252,shard-0000353,shard-0000201,shard-0000083,shard-0000310,shard-0000014,shard-0000093,shard-0000107,shard-0000345,shard-0000176,shard-0000219,shard-0000167,shard-0000094,shard-0000137,shard-0000002,shard-0000323,shard-0000058,shard-0000274,shard-0000326,shard-0000343,shard-0000073,shard-0000108,shard-0000351,shard-0000056,shard-0000290}.tar -" "pipe:aws s3 cp s3://llched-raw/open_lm_run_processed_data/sampled_process/train_02_preproc/{5,2,4,3,0,6,7,1}/{shard-0000132,shard-0000055,shard-0000052,shard-0000153,shard-0000057,shard-0000151,shard-0000096,shard-0000004,shard-0000051,shard-0000112,shard-0000025,shard-0000040,shard-0000129,shard-0000110,shard-0000105,shard-0000080,shard-0000053,shard-0000050,shard-0000012,shard-0000091,shard-0000098,shard-0000104,shard-0000117,shard-0000071,shard-0000019,shard-0000062,shard-0000010,shard-0000089,shard-0000035,shard-0000024,shard-0000016,shard-0000000,shard-0000028,shard-0000079,shard-0000029,shard-0000036,shard-0000030,shard-0000102,shard-0000045,shard-0000140,shard-0000146,shard-0000048,shard-0000135,shard-0000150,shard-0000044,shard-0000141,shard-0000142,shard-0000109,shard-0000068,shard-0000001,shard-0000145,shard-0000046,shard-0000082,shard-0000026,shard-0000063,shard-0000157,shard-0000031,shard-0000101,shard-0000037,shard-0000074,shard-0000021,shard-0000139,shard-0000159,shard-0000047,shard-0000007,shard-0000152,shard-0000149,shard-0000115,shard-0000084,shard-0000100,shard-0000087,shard-0000015,shard-0000011,shard-0000114,shard-0000088,shard-0000038,shard-0000013,shard-0000143,shard-0000003,shard-0000075,shard-0000086,shard-0000119,shard-0000125,shard-0000059,shard-0000027,shard-0000022,shard-0000138,shard-0000090,shard-0000032,shard-0000077,shard-0000085,shard-0000106,shard-0000008,shard-0000078,shard-0000126,shard-0000005,shard-0000009,shard-0000017,shard-0000034,shard-0000065,shard-0000069,shard-0000097,shard-0000099,shard-0000020,shard-0000147,shard-0000066,shard-0000072,shard-0000023,shard-0000154,shard-0000134,shard-0000131,shard-0000092,shard-0000049,shard-0000070,shard-0000155,shard-0000123,shard-0000120,shard-0000156,shard-0000127,shard-0000136,shard-0000006,shard-0000043,shard-0000144,shard-0000118,shard-0000113,shard-0000133,shard-0000039,shard-0000064,shard-0000081,shard-0000083,shard-0000054,shard-0000033,shard-0000014,shard-0000124,shard-0000076,shard-0000093,shard-0000107,shard-0000095,shard-0000018,shard-0000122,shard-0000094,shard-0000111,shard-0000116,shard-0000137,shard-0000060,shard-0000002,shard-0000058,shard-0000103,shard-0000042,shard-0000121,shard-0000158,shard-0000073,shard-0000130,shard-0000108,shard-0000067,shard-0000148,shard-0000056,shard-0000160,shard-0000128,shard-0000041,shard-0000061}.tar -" "pipe:aws s3 cp s3://llched-raw/open_lm_run_processed_data/sampled_process/train_01_preproc/{5,2,4,3,0,6,7,1}/{shard-0000257,shard-0000371,shard-0000432,shard-0000352,shard-0000151,shard-0000210,shard-0000096,shard-0000302,shard-0000025,shard-0000040,shard-0000428,shard-0000218,shard-0000105,shard-0000261,shard-0000193,shard-0000091,shard-0000354,shard-0000211,shard-0000450,shard-0000204,shard-0000212,shard-0000317,shard-0000222,shard-0000437,shard-0000268,shard-0000294,shard-0000267,shard-0000430,shard-0000203,shard-0000145,shard-0000001,shard-0000181,shard-0000348,shard-0000358,shard-0000026,shard-0000388,shard-0000196,shard-0000101,shard-0000021,shard-0000360,shard-0000231,shard-0000329,shard-0000115,shard-0000084,shard-0000427,shard-0000015,shard-0000266,shard-0000206,shard-0000277,shard-0000011,shard-0000255,shard-0000301,shard-0000411,shard-0000208,shard-0000143,shard-0000237,shard-0000075,shard-0000086,shard-0000248,shard-0000415,shard-0000027,shard-0000022,shard-0000254,shard-0000339,shard-0000367,shard-0000077,shard-0000295,shard-0000085,shard-0000106,shard-0000276,shard-0000162,shard-0000235,shard-0000069,shard-0000020,shard-0000226,shard-0000147,shard-0000207,shard-0000270,shard-0000202,shard-0000309,shard-0000386,shard-0000199,shard-0000307,shard-0000136,shard-0000451,shard-0000184,shard-0000340,shard-0000368,shard-0000331,shard-0000382,shard-0000216,shard-0000337,shard-0000234,shard-0000039,shard-0000064,shard-0000279,shard-0000448,shard-0000033,shard-0000124,shard-0000095,shard-0000018,shard-0000185,shard-0000191,shard-0000240,shard-0000217,shard-0000429,shard-0000111,shard-0000116,shard-0000197,shard-0000232,shard-0000158,shard-0000130,shard-0000148,shard-0000359,shard-0000153,shard-0000052,shard-0000401,shard-0000004,shard-0000112,shard-0000392,shard-0000110,shard-0000050,shard-0000273,shard-0000098,shard-0000286,shard-0000104,shard-0000350,shard-0000190,shard-0000062,shard-0000251,shard-0000220,shard-0000028,shard-0000029,shard-0000036,shard-0000396,shard-0000445,shard-0000150,shard-0000250,shard-0000356,shard-0000068,shard-0000246,shard-0000292,shard-0000454,shard-0000314,shard-0000425,shard-0000074,shard-0000335,shard-0000007,shard-0000149,shard-0000100,shard-0000439,shard-0000259,shard-0000179,shard-0000164,shard-0000224,shard-0000363,shard-0000393,shard-0000205,shard-0000380,shard-0000013,shard-0000059,shard-0000172,shard-0000269,shard-0000215,shard-0000395,shard-0000412,shard-0000241,shard-0000090,shard-0000376,shard-0000034,shard-0000349,shard-0000291,shard-0000263,shard-0000379,shard-0000421,shard-0000281,shard-0000230,shard-0000409,shard-0000346,shard-0000233,shard-0000330,shard-0000414,shard-0000390,shard-0000166,shard-0000441,shard-0000165,shard-0000420,shard-0000383,shard-0000377,shard-0000131,shard-0000311,shard-0000195,shard-0000070,shard-0000156,shard-0000120,shard-0000043,shard-0000256,shard-0000336,shard-0000398,shard-0000144,shard-0000118,shard-0000225,shard-0000113,shard-0000054,shard-0000076,shard-0000122,shard-0000271,shard-0000334,shard-0000042,shard-0000249,shard-0000424,shard-0000305,shard-0000121,shard-0000362,shard-0000375,shard-0000221,shard-0000160,shard-0000168,shard-0000227,shard-0000385,shard-0000453,shard-0000057,shard-0000303,shard-0000129,shard-0000265,shard-0000449,shard-0000080,shard-0000374,shard-0000327,shard-0000434,shard-0000117,shard-0000019,shard-0000010,shard-0000089,shard-0000285,shard-0000024,shard-0000016,shard-0000365,shard-0000312,shard-0000000,shard-0000419,shard-0000079,shard-0000030,shard-0000245,shard-0000282,shard-0000102,shard-0000045,shard-0000048,shard-0000141,shard-0000142,shard-0000366,shard-0000178,shard-0000046,shard-0000198,shard-0000163,shard-0000209,shard-0000063,shard-0000180,shard-0000347,shard-0000391,shard-0000372,shard-0000306,shard-0000258,shard-0000139,shard-0000159,shard-0000047,shard-0000152,shard-0000426,shard-0000087,shard-0000319,shard-0000114,shard-0000297,shard-0000169,shard-0000446,shard-0000373,shard-0000455,shard-0000384,shard-0000238,shard-0000394,shard-0000253,shard-0000244,shard-0000078,shard-0000005,shard-0000260,shard-0000283,shard-0000009,shard-0000017,shard-0000065,shard-0000097,shard-0000228,shard-0000023,shard-0000154,shard-0000134,shard-0000298,shard-0000092,shard-0000370,shard-0000433,shard-0000242,shard-0000369,shard-0000155,shard-0000123,shard-0000127,shard-0000342,shard-0000435,shard-0000188,shard-0000243,shard-0000275,shard-0000417,shard-0000262,shard-0000133,shard-0000081,shard-0000288,shard-0000170,shard-0000406,shard-0000182,shard-0000404,shard-0000272,shard-0000387,shard-0000177,shard-0000060,shard-0000315,shard-0000103,shard-0000214,shard-0000189,shard-0000316,shard-0000333,shard-0000378,shard-0000341,shard-0000067,shard-0000416,shard-0000128,shard-0000041,shard-0000061,shard-0000132,shard-0000055,shard-0000397,shard-0000051,shard-0000053,shard-0000322,shard-0000012,shard-0000171,shard-0000071,shard-0000192,shard-0000318,shard-0000035,shard-0000264,shard-0000280,shard-0000422,shard-0000200,shard-0000146,shard-0000140,shard-0000364,shard-0000135,shard-0000173,shard-0000399,shard-0000293,shard-0000044,shard-0000109,shard-0000296,shard-0000082,shard-0000321,shard-0000186,shard-0000157,shard-0000031,shard-0000239,shard-0000037,shard-0000229,shard-0000447,shard-0000320,shard-0000444,shard-0000405,shard-0000442,shard-0000183,shard-0000223,shard-0000284,shard-0000313,shard-0000328,shard-0000456,shard-0000088,shard-0000038,shard-0000003,shard-0000247,shard-0000287,shard-0000400,shard-0000125,shard-0000119,shard-0000325,shard-0000357,shard-0000300,shard-0000138,shard-0000194,shard-0000381,shard-0000407,shard-0000289,shard-0000032,shard-0000440,shard-0000174,shard-0000187,shard-0000008,shard-0000126,shard-0000308,shard-0000344,shard-0000408,shard-0000338,shard-0000413,shard-0000099,shard-0000332,shard-0000213,shard-0000304,shard-0000066,shard-0000175,shard-0000072,shard-0000452,shard-0000355,shard-0000299,shard-0000324,shard-0000402,shard-0000161,shard-0000049,shard-0000443,shard-0000278,shard-0000236,shard-0000006,shard-0000436,shard-0000252,shard-0000353,shard-0000389,shard-0000418,shard-0000201,shard-0000083,shard-0000310,shard-0000014,shard-0000093,shard-0000107,shard-0000361,shard-0000345,shard-0000176,shard-0000219,shard-0000167,shard-0000094,shard-0000137,shard-0000002,shard-0000323,shard-0000403,shard-0000058,shard-0000274,shard-0000326,shard-0000343,shard-0000073,shard-0000108,shard-0000410,shard-0000351,shard-0000056,shard-0000438,shard-0000431,shard-0000290,shard-0000423}.tar -" "pipe:aws s3 cp s3://llched-raw/open_lm_run_processed_data/arvix/preproc_data_arxiv_train/{5,2,4,3,0,6,7,1}/{shard-0000046,shard-0000055,shard-0000052,shard-0000068,shard-0000057,shard-0000032,shard-0000026,shard-0000063,shard-0000004,shard-0000031,shard-0000051,shard-0000025,shard-0000008,shard-0000040,shard-0000053,shard-0000005,shard-0000050,shard-0000012,shard-0000039,shard-0000064,shard-0000037,shard-0000021,shard-0000033,shard-0000054,shard-0000014,shard-0000009,shard-0000017,shard-0000034,shard-0000065,shard-0000047,shard-0000001,shard-0000018,shard-0000019,shard-0000007,shard-0000062,shard-0000010,shard-0000020,shard-0000035,shard-0000024,shard-0000016,shard-0000060,shard-0000066,shard-0000002,shard-0000015,shard-0000000,shard-0000028,shard-0000058,shard-0000023,shard-0000042,shard-0000029,shard-0000036,shard-0000011,shard-0000030,shard-0000045,shard-0000038,shard-0000013,shard-0000048,shard-0000003,shard-0000067,shard-0000049,shard-0000044,shard-0000056,shard-0000059,shard-0000027,shard-0000022,shard-0000041,shard-0000061,shard-0000006,shard-0000043}.tar -" \
    --val-data "pipe:aws s3 cp s3://llched-raw/open_lm_run_processed_data/europmc_valid/preproc_data_europmc_ft_valid/{5,0,7,3,1,2,6,4}/{shard-0000002,shard-0000001,shard-0000000}.tar -" "pipe:aws s3 cp s3://llched-raw/open_lm_run_processed_data/open-web-math/preproc_data_proof-pile-2_open-web-math_validation/{5,3,2,6,4}/{shard-0000196,shard-0000236,shard-0000029,shard-0000300,shard-0000294,shard-0000293,shard-0000074,shard-0000307,shard-0000075,shard-0000108,shard-0000311,shard-0000315,shard-0000060,shard-0000000,shard-0000066,shard-0000160,shard-0000292,shard-0000103,shard-0000124,shard-0000203,shard-0000128,shard-0000277,shard-0000290,shard-0000302,shard-0000138,shard-0000295,shard-0000184,shard-0000243,shard-0000165,shard-0000044,shard-0000230,shard-0000072,shard-0000122,shard-0000139,shard-0000271,shard-0000312,shard-0000123,shard-0000299,shard-0000250,shard-0000107,shard-0000219,shard-0000040,shard-0000208,shard-0000009,shard-0000252,shard-0000217,shard-0000095,shard-0000062,shard-0000267,shard-0000142,shard-0000170,shard-0000013,shard-0000199,shard-0000083,shard-0000281,shard-0000112,shard-0000092,shard-0000320,shard-0000225,shard-0000191,shard-0000183,shard-0000082,shard-0000251,shard-0000150,shard-0000096,shard-0000289,shard-0000058,shard-0000001,shard-0000011,shard-0000045,shard-0000038,shard-0000272,shard-0000119,shard-0000317,shard-0000282,shard-0000080,shard-0000244,shard-0000287,shard-0000048,shard-0000146,shard-0000091,shard-0000322,shard-0000024,shard-0000030,shard-0000051,shard-0000157,shard-0000308,shard-0000181,shard-0000288,shard-0000274,shard-0000213,shard-0000259,shard-0000134,shard-0000063,shard-0000019,shard-0000285,shard-0000233,shard-0000116,shard-0000163,shard-0000276,shard-0000327,shard-0000071,shard-0000232,shard-0000296,shard-0000100,shard-0000113,shard-0000283,shard-0000022,shard-0000154,shard-0000179,shard-0000155,shard-0000192,shard-0000223,shard-0000186,shard-0000334,shard-0000210,shard-0000260,shard-0000105,shard-0000220,shard-0000135,shard-0000189,shard-0000101,shard-0000149,shard-0000263,shard-0000118,shard-0000258,shard-0000215,shard-0000226,shard-0000028,shard-0000164,shard-0000242,shard-0000245,shard-0000012,shard-0000333,shard-0000065,shard-0000106,shard-0000177,shard-0000017,shard-0000054,shard-0000279,shard-0000098,shard-0000043,shard-0000273,shard-0000216,shard-0000309,shard-0000089,shard-0000321,shard-0000323,shard-0000270,shard-0000031,shard-0000235,shard-0000303,shard-0000318,shard-0000195,shard-0000014,shard-0000291,shard-0000023,shard-0000136,shard-0000197,shard-0000120,shard-0000325,shard-0000109,shard-0000246,shard-0000335,shard-0000055,shard-0000206,shard-0000129,shard-0000185,shard-0000004,shard-0000035,shard-0000265,shard-0000313,shard-0000041,shard-0000027,shard-0000081,shard-0000268,shard-0000316,shard-0000212,shard-0000077,shard-0000332,shard-0000198,shard-0000172,shard-0000240,shard-0000209,shard-0000132,shard-0000180,shard-0000090,shard-0000178,shard-0000200,shard-0000140,shard-0000305,shard-0000264,shard-0000326,shard-0000003,shard-0000084,shard-0000238,shard-0000187,shard-0000324,shard-0000086,shard-0000110,shard-0000306,shard-0000115,shard-0000314,shard-0000097,shard-0000006,shard-0000278,shard-0000007,shard-0000036,shard-0000193,shard-0000046,shard-0000329,shard-0000087,shard-0000141,shard-0000234,shard-0000284,shard-0000034,shard-0000033,shard-0000069,shard-0000026,shard-0000194,shard-0000304,shard-0000222,shard-0000111,shard-0000262,shard-0000227,shard-0000261,shard-0000211,shard-0000207,shard-0000099,shard-0000167,shard-0000280,shard-0000093,shard-0000130,shard-0000056,shard-0000015,shard-0000254,shard-0000248,shard-0000158,shard-0000117,shard-0000156,shard-0000166,shard-0000237,shard-0000102,shard-0000175,shard-0000052,shard-0000297,shard-0000016,shard-0000319,shard-0000301,shard-0000125,shard-0000126,shard-0000221,shard-0000143,shard-0000218,shard-0000176,shard-0000042,shard-0000249,shard-0000067,shard-0000047,shard-0000204,shard-0000021,shard-0000121,shard-0000328,shard-0000005,shard-0000039,shard-0000188,shard-0000229,shard-0000020,shard-0000002,shard-0000255,shard-0000286,shard-0000153,shard-0000032,shard-0000169,shard-0000018,shard-0000298,shard-0000131,shard-0000228,shard-0000133,shard-0000145,shard-0000078,shard-0000050,shard-0000151,shard-0000053,shard-0000137,shard-0000269,shard-0000049,shard-0000239,shard-0000247,shard-0000266,shard-0000127,shard-0000008,shard-0000070,shard-0000079,shard-0000094,shard-0000173,shard-0000174,shard-0000256,shard-0000162,shard-0000159,shard-0000148,shard-0000104,shard-0000202,shard-0000275,shard-0000085,shard-0000241,shard-0000205,shard-0000168,shard-0000068,shard-0000144,shard-0000310,shard-0000161,shard-0000182,shard-0000076,shard-0000010,shard-0000331,shard-0000147,shard-0000330,shard-0000114,shard-0000025,shard-0000064,shard-0000171,shard-0000253,shard-0000201,shard-0000059,shard-0000231,shard-0000037,shard-0000061,shard-0000088,shard-0000057,shard-0000073,shard-0000224,shard-0000214,shard-0000257,shard-0000190,shard-0000152}.tar -" "pipe:aws s3 cp s3://llched-raw/open_lm_run_processed_data/peS2o/preproc_data_peS2o_valid_clean/{5,0,7,3,1,2,6,4}/{shard-0000001,shard-0000005,shard-0000003,shard-0000004,shard-0000000,shard-0000002}.tar -" "pipe:aws s3 cp s3://llched-raw/open_lm_run_processed_data/nougat_process/nougat_medrxiv_valid/0/{shard-0000002,shard-0000001,shard-0000000}.tar -" "pipe:aws s3 cp s3://llched-raw/open_lm_run_processed_data/nougat_process/nougat_chemrxiv_valid/0/{shard-0000002,shard-0000001,shard-0000000}.tar -" "pipe:aws s3 cp s3://llched-raw/open_lm_run_processed_data/nougat_process/nougat_bioxriv_valid/{1,6}/{shard-0000002,shard-0000001,shard-0000000}.tar -" "pipe:aws s3 cp s3://llched-raw/open_lm_run_processed_data/arvix/preproc_data_arxiv_valid/{5,0,7,3,1,2,6,4}/{shard-0000007,shard-0000009,shard-0000001,shard-0000010,shard-0000005,shard-0000003,shard-0000004,shard-0000000,shard-0000008,shard-0000002,shard-0000006}.tar -" "pipe:aws s3 cp s3://llched-raw/open_lm_run_processed_data/chemnlp_valid/preproc_data_chemnlp_valid/{5,0,7,3,1,2,6,4}/{shard-0000196,shard-0000236,shard-0000029,shard-0000300,shard-0000294,shard-0000293,shard-0000074,shard-0000307,shard-0000075,shard-0000108,shard-0000311,shard-0000315,shard-0000060,shard-0000000,shard-0000066,shard-0000160,shard-0000292,shard-0000103,shard-0000124,shard-0000203,shard-0000128,shard-0000277,shard-0000290,shard-0000302,shard-0000138,shard-0000295,shard-0000184,shard-0000243,shard-0000165,shard-0000044,shard-0000230,shard-0000072,shard-0000122,shard-0000139,shard-0000271,shard-0000312,shard-0000123,shard-0000299,shard-0000250,shard-0000107,shard-0000219,shard-0000040,shard-0000208,shard-0000009,shard-0000252,shard-0000217,shard-0000095,shard-0000062,shard-0000267,shard-0000142,shard-0000170,shard-0000013,shard-0000199,shard-0000083,shard-0000281,shard-0000112,shard-0000092,shard-0000320,shard-0000225,shard-0000191,shard-0000183,shard-0000082,shard-0000251,shard-0000150,shard-0000096,shard-0000289,shard-0000058,shard-0000001,shard-0000011,shard-0000045,shard-0000038,shard-0000272,shard-0000119,shard-0000317,shard-0000282,shard-0000080,shard-0000244,shard-0000287,shard-0000048,shard-0000146,shard-0000091,shard-0000322,shard-0000024,shard-0000030,shard-0000051,shard-0000157,shard-0000308,shard-0000181,shard-0000288,shard-0000274,shard-0000213,shard-0000259,shard-0000134,shard-0000063,shard-0000019,shard-0000285,shard-0000233,shard-0000116,shard-0000163,shard-0000276,shard-0000327,shard-0000071,shard-0000232,shard-0000296,shard-0000100,shard-0000113,shard-0000283,shard-0000022,shard-0000154,shard-0000179,shard-0000155,shard-0000192,shard-0000223,shard-0000186,shard-0000334,shard-0000210,shard-0000260,shard-0000105,shard-0000220,shard-0000135,shard-0000189,shard-0000101,shard-0000149,shard-0000263,shard-0000118,shard-0000258,shard-0000215,shard-0000226,shard-0000028,shard-0000164,shard-0000242,shard-0000245,shard-0000012,shard-0000333,shard-0000065,shard-0000106,shard-0000177,shard-0000017,shard-0000054,shard-0000279,shard-0000098,shard-0000043,shard-0000273,shard-0000216,shard-0000309,shard-0000089,shard-0000321,shard-0000323,shard-0000270,shard-0000031,shard-0000235,shard-0000303,shard-0000318,shard-0000195,shard-0000014,shard-0000291,shard-0000023,shard-0000136,shard-0000197,shard-0000120,shard-0000325,shard-0000109,shard-0000246,shard-0000335,shard-0000055,shard-0000206,shard-0000129,shard-0000185,shard-0000004,shard-0000035,shard-0000265,shard-0000313,shard-0000041,shard-0000027,shard-0000081,shard-0000268,shard-0000316,shard-0000212,shard-0000077,shard-0000332,shard-0000198,shard-0000172,shard-0000240,shard-0000209,shard-0000132,shard-0000180,shard-0000090,shard-0000178,shard-0000200,shard-0000140,shard-0000305,shard-0000264,shard-0000326,shard-0000003,shard-0000084,shard-0000238,shard-0000187,shard-0000324,shard-0000086,shard-0000110,shard-0000306,shard-0000115,shard-0000314,shard-0000097,shard-0000006,shard-0000278,shard-0000007,shard-0000036,shard-0000193,shard-0000046,shard-0000329,shard-0000087,shard-0000141,shard-0000234,shard-0000284,shard-0000034,shard-0000033,shard-0000069,shard-0000026,shard-0000194,shard-0000304,shard-0000222,shard-0000111,shard-0000262,shard-0000227,shard-0000261,shard-0000211,shard-0000207,shard-0000099,shard-0000167,shard-0000280,shard-0000093,shard-0000130,shard-0000056,shard-0000015,shard-0000254,shard-0000248,shard-0000158,shard-0000117,shard-0000156,shard-0000166,shard-0000237,shard-0000102,shard-0000175,shard-0000052,shard-0000297,shard-0000016,shard-0000319,shard-0000301,shard-0000125,shard-0000126,shard-0000221,shard-0000143,shard-0000218,shard-0000176,shard-0000042,shard-0000249,shard-0000067,shard-0000047,shard-0000204,shard-0000021,shard-0000121,shard-0000328,shard-0000005,shard-0000039,shard-0000188,shard-0000229,shard-0000020,shard-0000002,shard-0000255,shard-0000286,shard-0000153,shard-0000032,shard-0000169,shard-0000018,shard-0000298,shard-0000131,shard-0000228,shard-0000133,shard-0000145,shard-0000078,shard-0000050,shard-0000151,shard-0000053,shard-0000137,shard-0000269,shard-0000049,shard-0000239,shard-0000247,shard-0000266,shard-0000127,shard-0000008,shard-0000070,shard-0000079,shard-0000094,shard-0000173,shard-0000174,shard-0000256,shard-0000162,shard-0000159,shard-0000148,shard-0000104,shard-0000202,shard-0000275,shard-0000085,shard-0000241,shard-0000205,shard-0000168,shard-0000068,shard-0000144,shard-0000310,shard-0000161,shard-0000182,shard-0000076,shard-0000010,shard-0000331,shard-0000147,shard-0000330,shard-0000114,shard-0000025,shard-0000064,shard-0000171,shard-0000253,shard-0000201,shard-0000059,shard-0000231,shard-0000037,shard-0000061,shard-0000088,shard-0000057,shard-0000073,shard-0000224,shard-0000214,shard-0000257,shard-0000190,shard-0000152}.tar -" \
    --dataset-resampled \
    --precision amp_bfloat16 \
    --global-batch-size $BATCHSIZE \
    --grad-checkpointing \
    --log-every-n-steps 20 \
    --grad-clip-norm 1 \
    --lr $LR \
    --warmup 2000 \
    --model $MODEL \
    --wd $WD \
    --beta2 0.95 \
    --epochs 64 \
    --report-to wandb \
    --wandb-project-name lm1 \
    --name $EXP_NAME \
    --logs /weka/home-kjablonk/openlm_test6 \
    --resume latest \
    --data-key 'txt' \
    --lr-cooldown-end 3e-5 #\
#    --fsdp \
#     --fsdp-limit-all-gathers \
#    --fsdp-amp \
